# Word Cloud Generator

## 概要
テキストデータからワードクラウドを生成するツールです。日本語テキストに対応しており、形態素解析による名詞抽出を行います。特にCSVファイルの特定列からのワードクラウド生成に適しています。

## 機能
- CSVファイルからのテキスト読み込み
- 日本語テキストの形態素解析
- 名詞の抽出と頻度分析
- カスタマイズ可能なワードクラウド生成
  - フォントサイズ調整（20-100px）
  - 横書き優先レイアウト
  - 白背景
  - 日本語フォント対応

## 必要要件
- Python 3.x
- pandas
- janome
- wordcloud
- matplotlib
- PIL (Pillow)

## インストール方法
必要なパッケージをインストール：
```bash
pip install pandas janome wordcloud matplotlib pillow
```

## 使用方法
### 基本的な使用方法
```bash
python generate_wordcloud.py <csvファイルパス>
```

### 特定の列を指定して実行
```bash
python generate_wordcloud.py <csvファイルパス> <列名>
```

## 入力ファイル
- CSVファイル（UTF-8またはShift-JISエンコーディング）
- 自動的にエンコーディングを検出

## 出力
- ワードクラウド画像がoutputディレクトリに保存されます
- ファイル名形式：
  - 全列使用時：`{元ファイル名}_wordcloud.png`
  - 特定列指定時：`{元ファイル名}_{列名}_wordcloud.png`

## サンプルデータ
`samples`ディレクトリに以下のサンプルファイルが含まれています：
- customer_survey.csv：顧客アンケートのサンプルデータ
- sample_survey.csv：一般的なアンケートのサンプルデータ

## ワードクラウド設定
- 画像サイズ：800×600ピクセル
- 背景色：白
- 最小フォントサイズ：20px
- 最大フォントサイズ：100px
- フォント：msgothic.ttc（日本語対応）
- 横書き優先（prefer_horizontal=1.0）

## 注意事項
- 大規模なテキストデータを処理する場合はメモリ使用量に注意
- 日本語フォントはシステムにインストールされている必要があります
- 形態素解析は名詞のみを対象としています
- 数値は除外されます
- 処理時間はテキストのサイズに依存します
